{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{API_URL}from\"../../config\";import{useNavigate}from\"react-router-dom\";import'./ProfileForm.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfileForm=()=>{const[userDetails,setUserDetails]=useState({name:'',email:'',phone:''});const[updatedDetails,setUpdatedDetails]=useState({name:'',email:'',phone:''});const[editMode,setEditMode]=useState(false);const navigate=useNavigate();useEffect(()=>{const authtoken=sessionStorage.getItem(\"auth-token\");if(!authtoken){navigate(\"/login\");}else{fetchUserProfile();}},[navigate]);const fetchUserProfile=async()=>{try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");if(!authtoken){navigate(\"/login\");return;}const response=await fetch(`${API_URL}/api/auth/user`,{headers:{\"Authorization\":`Bearer ${authtoken}`,\"Email\":email}});if(response.ok){const user=await response.json();setUserDetails(user);setUpdatedDetails(user);}else{throw new Error(\"Failed to fetch user profile\");}}catch(error){console.error(\"Error fetching user profile:\",error);}};const handleEdit=()=>{setEditMode(true);};const handleInputChange=e=>{const{name,value}=e.target;setUpdatedDetails(prevState=>({...prevState,[name]:value}));};const handleSubmit=async e=>{e.preventDefault();try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");if(!authtoken||!email){navigate(\"/login\");return;}const response=await fetch(`${API_URL}/api/auth/user`,{method:\"PUT\",headers:{\"Authorization\":`Bearer ${authtoken}`,\"Content-Type\":\"application/json\",\"Email\":email},body:JSON.stringify(updatedDetails)});if(response.ok){sessionStorage.setItem(\"name\",updatedDetails.name);sessionStorage.setItem(\"phone\",updatedDetails.phone);setUserDetails(updatedDetails);setEditMode(false);alert(\"Profile Updated Successfully!\");navigate(\"/\");// Ensure this route change does not interfere\n}else{throw new Error(\"Failed to update profile\");}}catch(error){console.error(\"Error updating profile:\",error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"profile-container\",children:editMode?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Email\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:updatedDetails.email,onChange:handleInputChange,disabled:true// Email field is disabled\n})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Name\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:updatedDetails.name,onChange:handleInputChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Phone\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phone\",value:updatedDetails.phone,onChange:handleInputChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-button\",onClick:()=>setEditMode(false),children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"profile-details\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, \",userDetails.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",userDetails.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Phone:\"}),\" \",userDetails.phone]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,children:\"Edit\"})]})});};export default ProfileForm;","map":{"version":3,"names":["React","useEffect","useState","API_URL","useNavigate","jsx","_jsx","jsxs","_jsxs","ProfileForm","userDetails","setUserDetails","name","email","phone","updatedDetails","setUpdatedDetails","editMode","setEditMode","navigate","authtoken","sessionStorage","getItem","fetchUserProfile","response","fetch","headers","ok","user","json","Error","error","console","handleEdit","handleInputChange","e","value","target","prevState","handleSubmit","preventDefault","method","body","JSON","stringify","setItem","alert","className","children","onSubmit","type","onChange","disabled","onClick"],"sources":["/home/project/med_app/src/Components/ProfileForm/ProfileForm.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { API_URL } from \"../../config\";\nimport { useNavigate } from \"react-router-dom\";\nimport './ProfileForm.css';\n\nconst ProfileForm = () => {\n  const [userDetails, setUserDetails] = useState({\n    name: '',\n    email: '',\n    phone: ''\n  });\n  const [updatedDetails, setUpdatedDetails] = useState({\n    name: '',\n    email: '',\n    phone: ''\n  });\n  const [editMode, setEditMode] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const authtoken = sessionStorage.getItem(\"auth-token\");\n    if (!authtoken) {\n      navigate(\"/login\");\n    } else {\n      fetchUserProfile();\n    }\n  }, [navigate]);\n\n  const fetchUserProfile = async () => {\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      if (!authtoken) {\n        navigate(\"/login\");\n        return;\n      }\n\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        headers: {\n          \"Authorization\": `Bearer ${authtoken}`,\n          \"Email\": email,\n        },\n      });\n\n      if (response.ok) {\n        const user = await response.json();\n        setUserDetails(user);\n        setUpdatedDetails(user);\n      } else {\n        throw new Error(\"Failed to fetch user profile\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching user profile:\", error);\n    }\n  };\n\n  const handleEdit = () => {\n    setEditMode(true);\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setUpdatedDetails(prevState => ({\n      ...prevState,\n      [name]: value\n    }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      if (!authtoken || !email) {\n        navigate(\"/login\");\n        return;\n      }\n\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        method: \"PUT\",\n        headers: {\n          \"Authorization\": `Bearer ${authtoken}`,\n          \"Content-Type\": \"application/json\",\n          \"Email\": email,\n        },\n        body: JSON.stringify(updatedDetails),\n      });\n\n      if (response.ok) {\n        sessionStorage.setItem(\"name\", updatedDetails.name);\n        sessionStorage.setItem(\"phone\", updatedDetails.phone);\n        setUserDetails(updatedDetails);\n        setEditMode(false);\n        alert(\"Profile Updated Successfully!\");\n        navigate(\"/\"); // Ensure this route change does not interfere\n      } else {\n        throw new Error(\"Failed to update profile\");\n      }\n    } catch (error) {\n      console.error(\"Error updating profile:\", error);\n    }\n  };\n\n  return (\n    <div className=\"profile-container\">\n      {editMode ? (\n        <form onSubmit={handleSubmit}>\n          <label>\n            Email\n            <input\n              type=\"email\"\n              name=\"email\"\n              value={updatedDetails.email}\n              onChange={handleInputChange}\n              disabled // Email field is disabled\n            />\n          </label>\n          <label>\n            Name\n            <input\n              type=\"text\"\n              name=\"name\"\n              value={updatedDetails.name}\n              onChange={handleInputChange}\n            />\n          </label>\n          <label>\n            Phone\n            <input\n              type=\"text\"\n              name=\"phone\"\n              value={updatedDetails.phone}\n              onChange={handleInputChange}\n            />\n          </label>\n          <button type=\"submit\">Save</button>\n          <button type=\"button\" className=\"cancel-button\" onClick={() => setEditMode(false)}>Cancel</button>\n        </form>\n      ) : (\n        <div className=\"profile-details\">\n          <h1>Welcome, {userDetails.name}</h1>\n          <p><b>Email:</b> {userDetails.email}</p>\n          <p><b>Phone:</b> {userDetails.phone}</p>\n          <button onClick={handleEdit}>Edit</button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ProfileForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}