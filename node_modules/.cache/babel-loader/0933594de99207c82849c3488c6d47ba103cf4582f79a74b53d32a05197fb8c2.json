{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{API_URL}from\"../../config\";import{useNavigate}from\"react-router-dom\";import ReportsLayout from\"../ReportsLayout/ReportsLayout\";import\"./ProfileCard.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfileCard=_ref=>{let{onProfileUpdate}=_ref;const[userDetails,setUserDetails]=useState({name:'',phone:'',email:''});const[editMode,setEditMode]=useState(false);const[updatedDetails,setUpdatedDetails]=useState({name:'',phone:'',email:''});const navigate=useNavigate();useEffect(()=>{const authtoken=sessionStorage.getItem(\"auth-token\");if(!authtoken){navigate(\"/login\");}else{fetchUserProfile();}},[navigate]);const fetchUserProfile=async()=>{try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");if(!authtoken||!email){navigate(\"/login\");return;}const response=await fetch(`${API_URL}/api/auth/user`,{headers:{\"Authorization\":`Bearer ${authtoken}`,\"Email\":email}});if(response.ok){const user=await response.json();setUserDetails(user);setUpdatedDetails({name:user.name||'',phone:user.phone||'',email:user.email||''});}else{throw new Error(\"Failed to fetch user profile\");}}catch(error){console.error(error);}};const handleInputChange=e=>{setUpdatedDetails({...updatedDetails,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();try{const authtoken=sessionStorage.getItem(\"auth-token\");const email=sessionStorage.getItem(\"email\");if(!authtoken||!email){navigate(\"/login\");return;}const payload={...updatedDetails};const response=await fetch(`${API_URL}/api/auth/user`,{method:\"PUT\",headers:{\"Authorization\":`Bearer ${authtoken}`,\"Content-Type\":\"application/json\",\"Email\":email},body:JSON.stringify(payload)});if(response.ok){sessionStorage.setItem(\"name\",updatedDetails.name);sessionStorage.setItem(\"phone\",updatedDetails.phone);setUserDetails(updatedDetails);setEditMode(false);alert(\"Profile Updated Successfully!\");if(onProfileUpdate&&typeof onProfileUpdate==='function'){onProfileUpdate(updatedDetails.name);// Notify App.js of the profile update\n}}else{throw new Error(\"Failed to update profile\");}}catch(error){console.error(error);}};const toggleEditMode=e=>{e.stopPropagation();setEditMode(prevEditMode=>!prevEditMode);};const handleFormClick=e=>{e.stopPropagation();};const handleShowReports=()=>{navigate('/reports');// Navigate to the ReportsLayout page\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://via.placeholder.com/80\",alt:\"Profile\",className:\"profile-pic\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Your Profile\"}),editMode?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,onClick:handleFormClick,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Name\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:updatedDetails.name,onChange:handleInputChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Phone\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phone\",value:updatedDetails.phone,onChange:handleInputChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Email\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:updatedDetails.email,disabled:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:toggleEditMode,children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"profile-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Name:\"}),\" \",userDetails.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Phone:\"}),\" \",userDetails.phone]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email:\"}),\" \",userDetails.email]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:toggleEditMode,children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleShowReports,children:\"Show Reports\"})]})]})]});};export default ProfileCard;","map":{"version":3,"names":["React","useState","useEffect","API_URL","useNavigate","ReportsLayout","jsx","_jsx","jsxs","_jsxs","ProfileCard","_ref","onProfileUpdate","userDetails","setUserDetails","name","phone","email","editMode","setEditMode","updatedDetails","setUpdatedDetails","navigate","authtoken","sessionStorage","getItem","fetchUserProfile","response","fetch","headers","ok","user","json","Error","error","console","handleInputChange","e","target","value","handleSubmit","preventDefault","payload","method","body","JSON","stringify","setItem","alert","toggleEditMode","stopPropagation","prevEditMode","handleFormClick","handleShowReports","className","children","src","alt","onSubmit","onClick","type","onChange","disabled"],"sources":["/home/project/med_appt_final/src/Components/ProfileCard/ProfileCard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { API_URL } from \"../../config\";\nimport { useNavigate } from \"react-router-dom\";\nimport ReportsLayout from \"../ReportsLayout/ReportsLayout\";\nimport \"./ProfileCard.css\";\n\nconst ProfileCard = ({ onProfileUpdate }) => {\n  const [userDetails, setUserDetails] = useState({\n    name: '',\n    phone: '',\n    email: ''\n  });\n  const [editMode, setEditMode] = useState(false);\n  const [updatedDetails, setUpdatedDetails] = useState({\n    name: '',\n    phone: '',\n    email: ''\n  });\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const authtoken = sessionStorage.getItem(\"auth-token\");\n    if (!authtoken) {\n      navigate(\"/login\");\n    } else {\n      fetchUserProfile();\n    }\n  }, [navigate]);\n\n  const fetchUserProfile = async () => {\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      if (!authtoken || !email) {\n        navigate(\"/login\");\n        return;\n      }\n\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        headers: {\n          \"Authorization\": `Bearer ${authtoken}`,\n          \"Email\": email,\n        },\n      });\n      if (response.ok) {\n        const user = await response.json();\n        setUserDetails(user);\n        setUpdatedDetails({\n          name: user.name || '',\n          phone: user.phone || '',\n          email: user.email || ''\n        });\n      } else {\n        throw new Error(\"Failed to fetch user profile\");\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleInputChange = (e) => {\n    setUpdatedDetails({\n      ...updatedDetails,\n      [e.target.name]: e.target.value,\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    try {\n      const authtoken = sessionStorage.getItem(\"auth-token\");\n      const email = sessionStorage.getItem(\"email\");\n\n      if (!authtoken || !email) {\n        navigate(\"/login\");\n        return;\n      }\n\n      const payload = { ...updatedDetails };\n      const response = await fetch(`${API_URL}/api/auth/user`, {\n        method: \"PUT\",\n        headers: {\n          \"Authorization\": `Bearer ${authtoken}`,\n          \"Content-Type\": \"application/json\",\n          \"Email\": email,\n        },\n        body: JSON.stringify(payload),\n      });\n\n      if (response.ok) {\n        sessionStorage.setItem(\"name\", updatedDetails.name);\n        sessionStorage.setItem(\"phone\", updatedDetails.phone);\n\n        setUserDetails(updatedDetails);\n        setEditMode(false);\n        alert(\"Profile Updated Successfully!\");\n        if (onProfileUpdate && typeof onProfileUpdate === 'function') {\n          onProfileUpdate(updatedDetails.name); // Notify App.js of the profile update\n        }\n      } else {\n        throw new Error(\"Failed to update profile\");\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const toggleEditMode = (e) => {\n    e.stopPropagation();\n    setEditMode(prevEditMode => !prevEditMode);\n  };\n\n  const handleFormClick = (e) => {\n    e.stopPropagation();\n  };\n\n  const handleShowReports = () => {\n    navigate('/reports'); // Navigate to the ReportsLayout page\n  };\n\n  return (\n    <div className=\"profile-card\">\n      <img\n        src=\"https://via.placeholder.com/80\"\n        alt=\"Profile\"\n        className=\"profile-pic\"\n      />\n      <h3>Your Profile</h3>\n      {editMode ? (\n        <form onSubmit={handleSubmit} onClick={handleFormClick}>\n          <label>\n            Name\n            <input\n              type=\"text\"\n              name=\"name\"\n              value={updatedDetails.name}\n              onChange={handleInputChange}\n            />\n          </label>\n          <label>\n            Phone\n            <input\n              type=\"text\"\n              name=\"phone\"\n              value={updatedDetails.phone}\n              onChange={handleInputChange}\n            />\n          </label>\n          <label>\n            Email\n            <input\n              type=\"email\"\n              name=\"email\"\n              value={updatedDetails.email}\n              disabled\n            />\n          </label>\n          <button type=\"submit\">Save</button>\n          <button type=\"button\" onClick={toggleEditMode}>Cancel</button>\n        </form>\n      ) : (\n        <div className=\"profile-details\">\n          <p><b>Name:</b> {userDetails.name}</p>\n          <p><b>Phone:</b> {userDetails.phone}</p>\n          <p><b>Email:</b> {userDetails.email}</p>\n          <div>\n            <button type=\"button\" onClick={toggleEditMode}>\n              Edit\n            </button>\n            <button type=\"button\" onClick={handleShowReports}>\n              Show Reports\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ProfileCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}